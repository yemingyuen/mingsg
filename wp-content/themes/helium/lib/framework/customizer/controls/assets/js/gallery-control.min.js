;(function(c,d){var b=c.customize,f=c.media&&c.media.gallery;b&&f&&(b.Youxi=b.Youxi||{},b.Youxi.GalleryControl=b.Control.extend({ids:function(){var a=this.setting();return a&&a.length?' ids="'+a.join(",")+'"':""},createView:function(a){return a.map(function(a){a=this.attachmentSize(a,"thumbnail").url;return d("<div />").append(d("<img />").attr("src",a))},this)},open:function(a){if(!b.utils.isKeydownButNotEnterEvent(a)){a.preventDefault();var e=f.edit("[gallery"+this.ids()+"]");e.state("gallery-edit").on("update",this.update);e.on("close",function(){e.detach()})}},update:function(a){this.view.html(this.createView(a));this.clearBtn.show();this.setting.set(a.pluck("id"))},clear:function(a){b.utils.isKeydownButNotEnterEvent(a)||(a.preventDefault(),this.view.empty(),this.clearBtn.hide(),this.setting.set([]))},attachmentSize:function(a,b){var c=a.attributes.sizes||{};return _.has(c,b)?_.pick(c[b],"url"):{url:a.url}},ready:function(){this.view=this.container.find(".youxi-gallery-control-view");this.clearBtn=this.container.find(".youxi-gallery-control-clear");_.bindAll(this,"open","update","clear");this.view.on("click keydown",this.open);this.clearBtn.on("click keydown",this.clear)}}),d.extend(b.controlConstructor,{youxi_gallery:b.Youxi.GalleryControl}))})(window.wp,jQuery);