/**
 * Youxi Shortcode TinyMCE Plugin
 *
 * This script contains the TinyMCE plugin for inserting shortcodes
 *
 * @package   Youxi Shortcode
 * @author    Mairel Theafila <maimairel@yahoo.com>
 * @copyright Copyright (c) 2013, Mairel Theafila
 */
;(function(c,h,k,l){"undefined"!=typeof tinymce&&c.Youxi&&c.Youxi.Shortcode&&tinymce.PluginManager.add("youxishortcode",function(d){function f(c){return c.instant?"youxiInsertShortcode":"youxiOpenShortcodeEditor"}d.addCommand("youxiOpenShortcodeEditor",function(e,b){c.Youxi.Shortcode.Editor(b.shortcode,[],function(a){d.execCommand("youxiInsertShortcode",!1,{shortcode:b.shortcode,data:a[b.shortcode]||{}})})});d.addCommand("youxiInsertShortcode",function(e,b){var a=b.data||{};_.isEmpty(a)&&c.Youxi.Shortcode.getSetting(b.shortcode,"instant")&&(a={content:youxiShortcodeSettings.defaultContent});a=c.Youxi.Shortcode.construct(b.shortcode,a);!c.Youxi.Shortcode.getSetting(b.shortcode,"inline")&&d.getParam("wpautop",!0)&&"object"==typeof switchEditors&&(a=switchEditors.wpautop(a));d.execCommand("mceInsertContent",!1,a)});d.addButton("youxi_shortcode_menu",{title:youxiShortcodeSettings.tinyMCEL10N&&youxiShortcodeSettings.tinyMCEL10N.shortcodeButtonTitle||"",type:"menubutton",icon:"youxi-shortcode",menu:function(){var e=youxiShortcodeSettings.args,b=e.categories||[],e=e.orphans||{},a=[];"tiny"!==youxiShortcodeSettings.tinyMceMode&&c.each(b,function(b,e){var g=c.map(e.shortcodes||{},function(a,b){if(("content"===d.id||a.inline)&&!a.internal)return{text:a.label,onclick:function(){d.execCommand(f(a),!1,{shortcode:b})}}});g.length&&a.push({text:e.args.label||b,menu:g})});c.each(e,function(b,c){c.internal||a.push({text:c.label,onclick:function(){d.execCommand(f(c),!1,{shortcode:b})}})});return a}()})})})(jQuery,window,document);